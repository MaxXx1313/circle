<!doctype html>
<html lang="en" ng-app="app">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pie</title>

    <!-- Page styles -->

    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">

  </head>

  <body ng-controller="mainCtrl as ctrl">

    <blockchain-pie data="ctrl.nodes"></blockchain-pie>

    <button ng-click="ctrl.addNode()">Add node</button>
    <button ng-click="ctrl.clear()">Clear</button>


    <!-- js libs -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/svg.js/2.3.4/svg.min.js"></script>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.7/angular.min.js"></script>


    <script src="directive.js"></script>
    <script>
      angular.module('app', ['MyBlockchain'])
      // angular.module('MyBlockchain', [])
      .controller('mainCtrl', function(){
        var ctrl = this;

        /**
         *
         */
        var dataExample = [
          {
            id: 1,
            loan:{ 2: {val:500} }
          },
          {
            id: 2,
            loan: { 3: {val:300} }
          },
          {
            id: 3,
            loan: { 1: {val:200} }
          }
        ];

        /**
         *
         */
        ctrl.nodes = dataExample;

        /**
         *
         */
        var i=4;
        ctrl.addNode = function(){
          var loanValue = parseInt(Math.random()*500);
          var loanTarget = parseInt(Math.random()*i);

          var loan = {};
          if(loanTarget>0){
           loan[loanTarget] = {val:loanValue};
          }
          ctrl.nodes.push({id:i, loan:loan});
          i++;
          console.log(dataExample);
        }

        /**
         *
         */
        ctrl.clear = function(){
          ctrl.nodes = [];
          i=0;
        }


      });
    </script>

  </body>
</html>
